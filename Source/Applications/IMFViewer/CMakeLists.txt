#--////////////////////////////////////////////////////////////////////////////
#--
#--  Copyright (c) 2015 BlueQuartz Software, LLC
#--  All rights reserved.
#--  BSD License: http://www.opensource.org/licenses/bsd-license.html
#--
#-- This code was partly written under US Air Force Contract FA8650-07-D-5800
#--
#--////////////////////////////////////////////////////////////////////////////
PROJECT( IMFViewer VERSION ${IMFViewerProj_VERSION_MAJOR}.${IMFViewerProj_VERSION_MINOR}.${IMFViewerProj_VERSION_PATCH})

# --------------------------------------------------------------------
# Look for Qt 5 as we need it for the plugin GUI to be generated
if(NOT Qt5Core_FOUND)
    message(FATAL_ERROR "Qt 5 is Needed for this project")
endif()


# Set the GUI type for different platforms
SET(GUI_TYPE )

# Set some Win32 Specific Settings
if(WIN32)
 SET(GUI_TYPE WIN32)
ENDif(WIN32)

SET(IMFViewer_MOC_HDRS
    ${IMFViewer_SOURCE_DIR}/IMFViewer_UI.h
    ${IMFViewer_SOURCE_DIR}/IMFViewerApplication.h
  )

SET(IMFViewer_HDRS

  )

set(IMFViewer_SRCS
  ${IMFViewer_SOURCE_DIR}/IMFViewer_UI.cpp
  ${IMFViewer_SOURCE_DIR}/IMFViewerApplication.cpp
  ${IMFViewer_SOURCE_DIR}/main.cpp
  )

cmp_IDE_SOURCE_PROPERTIES( "IMFViewer" "${IMFViewer_HDRS};${IMFViewer_MOC_HDRS}" "${IMFViewer_SRCS}" "${PROJECT_INSTALL_HEADERS}")

# The UI files As generated by Qt Designer
SET(IMFViewer_UIS
  ${IMFViewer_SOURCE_DIR}/UI_Files/IMFViewer_UI.ui
)

cmp_IDE_GENERATED_PROPERTIES("IMFViewer/UI_Files" "${IMFViewer_UIS}" "")

# and finally any resource files
# SET(IMFViewer_RCS ${IMFViewer_SOURCE_DIR}/Templates.qrc)
SET(IMFViewer_RCS
    ${PROJECT_RESOURCES_DIR}/icons/images/Icons.qrc
    ${ModerniProj_SOURCE_DIR}/Resources.qrc
)

# -- Run MOC and UIC on the necessary files
QT5_ADD_RESOURCES( IMFViewer_Generated_RC_SRCS ${IMFViewer_RCS} ${QRC_LICENSE_FILES})

# this will run uic on .ui files:
QT5_WRAP_UI( IMFViewer_Generated_UI_HDRS ${IMFViewer_UIS} )

# and finally this will run moc:
#QT5_WRAP_CPP( IMFViewer_Generated_MOC_SRCS ${IMFViewer_MOC_HDRS} )

#-- Put the generated files into their own group for IDEs
cmp_IDE_GENERATED_PROPERTIES("Generated/ui" "${IMFViewer_Generated_UI_HDRS}" "")
cmp_IDE_GENERATED_PROPERTIES("Generated/moc" "${IMFViewer_Generated_MOC_SRCS}" "")
cmp_IDE_GENERATED_PROPERTIES("Generated/qrc" "${QRC_LICENSE_FILES}" "${IMFViewer_Generated_RC_SRCS}")

# -- Include the Dialogs sources
include(${IMFViewer_SOURCE_DIR}/Dialogs/SourceList.cmake)

# -- Finally set the Project Sources to include all the sources
set(${PROJECT_NAME}_PROJECT_SRCS
  ${IMFViewer_SRCS}
  ${IMFViewer_HDRS}
  ${IMFViewer_MOC_HDRS}
  ${IMFViewer_Generated_RC_SRCS}
  ${IMFViewer_Generated_UI_HDRS}

  ${IMFViewer_Dialogs_Moc_HDRS}
  ${IMFViewer_Dialogs_HDRS}
  ${IMFViewer_Dialogs_SRCS}
  ${IMFViewer_Dialogs_Generated_UI_HDRS}

  ${IMFViewer_Dialogs_Utilities_Moc_HDRS}
  ${IMFViewer_Dialogs_Utilities_HDRS}
  ${IMFViewer_Dialogs_Utilities_SRCS}
  )

include_directories(${HDF5_INCLUDE_DIR})
include_directories(${IMFViewer_SOURCE_DIR} )
include_directories(${IMFViewer_SOURCE_DIR}/.. )
include_directories(${IMFViewer_BINARY_DIR} )
include_directories(${IMFViewer_BINARY_DIR} )
include_directories(${QtSupportLib_SOURCE_DIR} )


if(APPLE)
    set(APPLICATION_ICON ${PROJECT_RESOURCES_DIR}/icons/icns/${PROJECT_NAME}.icns)
endif(APPLE)

if(WIN32)
    set(APPLICATION_ICON ${PROJECT_RESOURCES_DIR}/icons/ico/${PROJECT_NAME}.ico)
ENDif(WIN32)

set(DEST_DIR ".")
if(UNIX AND NOT APPLE)
    set(DEST_DIR "bin")
endif()

BuildQtAppBundle(
    TARGET ${PROJECT_NAME}
    SOURCES ${IMFViewer_PROJECT_SRCS}
    DEBUG_EXTENSION ${EXE_DEBUG_EXTENSION}
    ICON_FILE  ${APPLICATION_ICON}
    VERSION_MAJOR ${DREAM3D_VER_MAJOR}
    VERSION_MINOR ${DREAM3D_VER_MINOR}
    VERSION_PATCH ${DREAM3D_VER_PATCH}
    BINARY_DIR    ${${PROJECT_NAME}_BINARY_DIR}
    LINK_LIBRARIES SIMPLib
    LIB_SEARCH_DIRS ${CMAKE_LIBRARY_OUTPUT_DIRECTORY} ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}
    QT5_MODULES   ${Qt5_COMPONENTS}
    COMPONENT     Applications
    INSTALL_DEST  ${DEST_DIR}
)


#- This installs all the help files. Note that we assume a flat directory structure
#- in the "Help" folder, ie, all html files, images, etc are all in the "Help"
#- folder and NOT in any subfolders beyond that.
install(DIRECTORY ${IMFViewer_SOURCE_DIR}/Template
        DESTINATION .
        COMPONENT Applications )
